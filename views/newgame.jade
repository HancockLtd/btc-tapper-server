extends layout

block content
  script.
    var socket = io.connect('http://localhost');

    //- socket.on('news', function (data) {
    //-   console.log(data);
    //-   socket.emit('my other event', { my: 'data' });
    //- });

    socket.on('create_user', function (data) {

      if (!user_id) {
        user_id = data.id;
        $.cookie('user_id', user_id);
      }
      console.log(user_id);
      $('.button').hide();
      $('.registered').show();
    });

    //event handler for notification

    socket.on('notification', function (data) {
      $('.notification').text(data.text);
    });

      //event handler for lobby size

    socket.on('lobby_size', function (data) {
      $('.lobbysize').text(data.size);
    });

    socket.on('game_announce', function (data) {
      // give a little time for the notification to appear
      // before we redirect to the new game window.
      setTimeout( function() {
        window.open('/game.html','_self');
      }, data.grace_period);
    });


  h1= title

  div#lobby
    div.background
    a(class='button', href='#') Join Game
    p(class='registered', style='display:none') You are now registered for this game.
    p(class='notification') 
    p
      | Lobby has 
      span(class='lobbysize') #{lobbysize}
      |  of&nbsp;
      span(class='maxlobby') #{maxlobby}
      |  participants

  script.
    $(function() {
      $('.button').click(function() {
        socket.emit('join_game', { id: user_id });
      });

    });